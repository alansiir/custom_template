<div class="container">
  <nav class="sidebar">
    <ul>
      <li *ngFor="let item of menuItems" class="menu-item">
        <button (click)="openModal(item)" class="menu-link">
          <i class="iconify" [attr.data-icon]="item.icon"></i>
        </button>
        <span class="menu-label">{{ item.label }}</span>
      </li>
    </ul>
  </nav>

  <!-- Fenêtre modale -->
  <div class="card-content" [ngClass]="{ 'is-open': isModalOpen }">
    <div class="modal-header">
      <h2>{{ selectedItem?.label }}</h2>
      <button class="close-btn" (click)="closeModal()">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="card-body">
      <div class="categories-content">
        <!-- Barre de recherche -->
        <div class="search-container">
          <input type="text" placeholder="Search" [(ngModel)]="searchQuery" (input)="filterComponents()">
          <button><i class="iconify" data-icon="mdi:magnify"></i></button>
        </div>

        <div class="categories-wrapper">
          <button class="nav left" (click)="scrollLeft()">❮</button>
          <div class="categories-container" #menuContainer>
            <button *ngFor="let item of menuItems; let i = index" class="menu-items"
              [class.active]="selectedItem === item" (click)="openModal(item)" [id]="'menu-item-' + i">
              {{ item.label }}
            </button>
          </div>
          <button class="nav right" (click)="scrollRight()">❯</button>
        </div>
      </div>

      <!-- Section dynamique pour les composants -->
      <div class="category-content">
        <!-- Utiliser filteredComponentsData pour afficher uniquement les composants filtrés -->
        <div *ngFor="let component of filteredComponentsData; let i = index">
          <ng-container *ngIf="selectedItem?.label === component.type">
            <div class="category-style">
              <ng-container [ngSwitch]="component.component">
                <app-table-comp *ngSwitchCase="'app-table-comp'"
                                [id]="'draggable-' + i"
                                class="draggable"
                                [ngStyle]="component.styles"
                                (dragstart)="startDrag($event)"
                                draggable="true">
                </app-table-comp>

                <button *ngSwitchCase="'button'"
                        [id]="'draggable-' + i"
                        class="draggable"
                        [ngStyle]="component.styles"
                        (dragstart)="startDrag($event)"
                        draggable="true">
                  Text
                </button>

                <div *ngSwitchCase="'div'"
                     [id]="'draggable-' + i"
                     class="draggable"
                     [ngStyle]="component.styles"
                     (dragstart)="startDrag($event)"
                     draggable="true">
                </div>

                <p *ngSwitchCase="'p'"
                   [id]="'draggable-' + i"
                   class="draggable"
                   [ngStyle]="component.styles"
                   (dragstart)="startDrag($event)"
                   draggable="true">
                  text
                </p>
              </ng-container>

              <span class="style-name">{{ component.label }}</span>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Zone cible pour le drag-and-drop -->
<div class="drop-zone" (dragover)="onDragOver($event)" (drop)="onDrop($event)"></div>